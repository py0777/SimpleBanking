<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="sb.repository.mapper.GenAcnoMapper">

	<select id="S001" parameterType="map" resultType="java.util.HashMap" ><![CDATA[
SELECT /*계좌번호 채번*/
       LPAD(COALESCE(MAX(ACNO),0) + 1,10,'0') AS ACNO  /*계좌번호*/
  FROM SB.RPB1000  /*잔고*/

]]>
	</select>

	<select id="S002" parameterType="map" resultType="java.util.HashMap" ><![CDATA[
SELECT ACNO  /*계좌번호*/
     , DACA  /*예수금*/
     , CUST_NM  /*예수금*/
     , OPRT_TR_DTM    /*조작거래일시*/
  FROM SB.RPB1000  /*잔고*/
 WHERE ACNO = ('${IN_ACNO}'

]]>
	</select>

	<insert id="I001" parameterType="map" resultType="java.util.HashMap" ><![CDATA[
INSERT INTO SB.RPD0100
(ACNO, LAST_TRNO, LAST_TRDT,OPRT_TR_DTM )
VALUES
('${IN_ACNO}', 0, '19700101', DATE_FORMAT(SYSDATE(),'%Y%m%d%H%i%s'))

]]>
	</insert>
	
	<insert id="I002" parameterType="map" resultType="java.util.HashMap" ><![CDATA[
INSERT INTO SB.RPB1000
(ACNO, DACA, CUST_NM,OPRT_TR_DTM )
VALUES
('${IN_ACNO}', 0, '${IN_CUST_NM}', DATE_FORMAT(SYSDATE(),'%Y%m%d%H%i%s'))

]]>
	</insert>
</mapper>